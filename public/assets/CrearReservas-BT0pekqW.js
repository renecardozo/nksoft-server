import{Q as u,q as V,T as B,r,j as e,U as $}from"./index-WtevhoQQ.js";var d={NVM_INC:"/Users/renecardozo/.nvm/versions/node/v18.18.0/include/node",MANPATH:"/Users/renecardozo/.nvm/versions/node/v18.18.0/share/man:/opt/homebrew/share/man:/usr/share/man:/usr/local/share/man:/Users/renecardozo/.nvm/versions/node/v18.18.0/share/man:/opt/homebrew/share/man::",TERM_PROGRAM:"vscode",NODE:"/Users/renecardozo/.nvm/versions/node/v18.18.0/bin/node",INIT_CWD:"/Users/renecardozo/Documents/TIS/patricia/projects/nksoft-ui",NVM_CD_FLAGS:"-q",SHELL:"/bin/zsh",TERM:"xterm-256color",npm_config_metrics_registry:"https://registry.npmjs.org/",TMPDIR:"/var/folders/cm/9dv3lvt54z162scbfz77x_r80000gn/T/",HOMEBREW_REPOSITORY:"/opt/homebrew",npm_config_global_prefix:"/Users/renecardozo/.nvm/versions/node/v18.18.0",TERM_PROGRAM_VERSION:"1.90.0",ZDOTDIR:"/Users/renecardozo",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",TERM_SESSION_ID:"w0t1p0:1935E2A4-F1BE-4BF2-B704-E82CDF45E77D",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renecardozo/Documents/TIS/patricia/projects/nksoft-ui",ZSH:"/Users/renecardozo/.oh-my-zsh",USER:"renecardozo",NVM_DIR:"/Users/renecardozo/.nvm",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renecardozo/.nvm/versions/node/v18.18.0/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.5Xx8k0d5J8/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/Users/renecardozo/.nvm/versions/node/v18.18.0/lib/node_modules/npm/bin/npm-cli.js",PAGER:"less",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renecardozo/Documents/TIS/patricia/projects/nksoft-ui/node_modules/.bin:/Users/renecardozo/Documents/TIS/patricia/projects/node_modules/.bin:/Users/renecardozo/Documents/TIS/patricia/node_modules/.bin:/Users/renecardozo/Documents/TIS/node_modules/.bin:/Users/renecardozo/Documents/node_modules/.bin:/Users/renecardozo/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renecardozo/.nvm/versions/node/v18.18.0/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/homebrew/opt/postgresql@12/bin:/opt/homebrew/opt/php@8.2/sbin:/opt/homebrew/opt/php@8.2/bin:/opt/homebrew/opt/mongodb-community@7.0/bin/:$/Users/renecardozo/.pyenv/versions/2.7.18/bin/python2.7:/Users/renecardozo/.pyenv/shims:/Users/renecardozo/.nvm/versions/node/v18.18.0/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/share/dotnet:~/.dotnet/tools:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/opt/homebrew/opt/postgresql@12/bin:/opt/homebrew/opt/php@7.4/sbin:/opt/homebrew/opt/php@7.4/bin:/opt/homebrew/opt/mongodb-community@7.0/bin/:$/Users/renecardozo/.pyenv/versions/2.7.18/bin/python2.7:/Users/renecardozo/.nvm/versions/node/v18.18.0/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/mysql-8.0.31-macos12-arm64/bin:/Applications/Visual Studio Code.app/Contents/Resources/app/bin:/usr/local/mysql-8.0.31-macos12-arm64/bin:/Applications/Visual Studio Code.app/Contents/Resources/app/bin",npm_package_json:"/Users/renecardozo/Documents/TIS/patricia/projects/nksoft-ui/package.json",_:"/Users/renecardozo/Documents/TIS/patricia/projects/nksoft-ui/node_modules/.bin/cross-env",npm_config_userconfig:"/Users/renecardozo/.npmrc",npm_config_init_module:"/Users/renecardozo/.npm-init.js",USER_ZDOTDIR:"/Users/renecardozo",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/renecardozo/Documents/TIS/patricia/projects/nksoft-ui",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"nksoft-ui",LANG:"en_US.UTF-8",ITERM_PROFILE:"Default",npm_config_npm_version:"9.8.1",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_config_node_gyp:"/Users/renecardozo/.nvm/versions/node/v18.18.0/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"0.1.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",COLORFGBG:"7;0",HOME:"/Users/renecardozo",SHLVL:"4",PYENV_SHELL:"zsh",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",LC_TERMINAL_VERSION:"3.4.18",HOMEBREW_PREFIX:"/opt/homebrew",ITERM_SESSION_ID:"w0t1p0:1935E2A4-F1BE-4BF2-B704-E82CDF45E77D",npm_config_cache:"/Users/renecardozo/.npm",LESS:"-R",LOGNAME:"renecardozo",npm_lifecycle_script:"cross-env PATH_API=http://newknowledge.tis.cs.umss.edu.bo vite build",VSCODE_GIT_IPC_HANDLE:"/var/folders/cm/9dv3lvt54z162scbfz77x_r80000gn/T/vscode-git-b2750e5af1.sock",LC_CTYPE:"UTF-8",NVM_BIN:"/Users/renecardozo/.nvm/versions/node/v18.18.0/bin",npm_config_user_agent:"npm/9.8.1 node/v18.18.0 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper (Plugin).app/Contents/MacOS/Code Helper (Plugin)",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:",LC_TERMINAL:"iTerm2",npm_node_execpath:"/Users/renecardozo/.nvm/versions/node/v18.18.0/bin/node",npm_config_prefix:"/Users/renecardozo/.nvm/versions/node/v18.18.0",COLORTERM:"truecolor",PATH_API:"http://newknowledge.tis.cs.umss.edu.bo",NODE_ENV:"production",PATH_API_TEST:"http://nksoft.tis.cs.umss.edu.bo"};const X=async()=>{try{return(await u.get(`${d.PATH_API}/api/periodos`)).data}catch(a){throw console.error("Error al obtener los periodos:",a),a}},q=async()=>{try{return(await u.get(`${d.PATH_API}/api/materias`)).data}catch(a){throw console.error("Error al obtener las materias:",a),a}},K=async()=>{try{const n=(await u.get(`${d.PATH_API}/api/materias`)).data;return Array.isArray(n)?n.map(i=>({id:i.id,nombre:i.grupo,materiaId:i.id})):(console.error("Error: materias no es un array"),[])}catch(a){throw console.error("Error al obtener los grupos de materias:",a),a}},W=async()=>{try{const a=await fetch(`${d.PATH_API}/api/aulas/mostrar`);if(!a.ok)throw new Error("Error al obtener las aulas");return await a.json()}catch(a){throw console.error("Error al obtener los datos de las aulas:",a),a}},Z=async a=>{try{const n=await u.post(`${d.PATH_API}/api/solicitud_reserva_aula`,a);return await V(a,"Created",0),console.log("Respuesta de la solicitud de reserva:",n.data),n.data}catch(n){throw console.error("Error al enviar la solicitud de reserva:",n),n}};function Y(){const n=B().state||{},[v,i]=r.useState(""),[P,U]=r.useState(null),[_,O]=r.useState([]),[h,f]=r.useState([]),[c,g]=r.useState("");r.useState([]);const[z,b]=r.useState([]),[M,x]=r.useState(""),[S,E]=r.useState(n.capacidadAulas||""),[j,N]=r.useState(""),[y,A]=r.useState(n.fecha||""),[I,C]=r.useState(n.id||""),[F,w]=r.useState([]),[t,R]=r.useState([]),[T,L]=r.useState([]),[m,D]=r.useState("");r.useEffect(()=>{(async()=>{try{const p=(await X()).map((l,H)=>({id:H+1,...l,nombreCompleto:`${l.horaInicio} - ${l.horaFin}`}));L(p)}catch(o){console.error("Error al obtener los periodos:",o)}})()},[]),r.useEffect(()=>{(async()=>{try{const o=await q();f(Array.isArray(o)?o:[])}catch(o){console.error("Error al obtener las materias:",o),f([])}})()},[]),r.useEffect(()=>{(async()=>{try{const o=await K();O(o)}catch(o){console.error("Error al obtener las materias y grupos:",o)}})()},[]),r.useEffect(()=>{if(c){const s=_.filter(o=>o.materiaId===parseInt(c));b(s)}else b([])},[c,_]),r.useEffect(()=>{(async()=>{try{const o=await W();console.log("Datos de aulas obtenidos:",o),w(Array.isArray(o)?o:[])}catch(o){console.error("Error al obtener las aulas:",o),w([])}})()},[]),r.useEffect(()=>{const s=localStorage.getItem("user_data");if(s){const o=JSON.parse(s);U(o),i(o.name)}},[]);const G=async()=>{try{const s={id_user:P.id,id_materia:parseInt(c),periodos:t.map(o=>o.id),id_aula:I,fecha_hora_reserva:y,cantidad_estudiantes:parseInt(S),motivo_reserva:j,observaciones:document.getElementById("observaciones").value};await Z(s),g(""),x(""),E(""),N(""),A(""),C(""),R([]),alert("Reserva registrada correctamente")}catch(s){console.error("Error al registrar la reserva:",s),alert("Ocurrió un error al registrar la reserva. Por favor, inténtelo de nuevo.")}},k=()=>{if(!m){alert("Debe seleccionar un período primero.");return}if(t.some(o=>o.id===parseInt(m))){alert("Este período ya ha sido seleccionado.");return}const s=T.find(o=>o.id===parseInt(m));R([...t,s]),D("")};return e.jsx("div",{className:"container",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"mb-0",children:"Solicitud de registro de aula"})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"nombre",className:"fw-bold",children:"Nombre"}),e.jsx("input",{type:"text",id:"nombre",className:"form-control",value:v,disabled:!0})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"materia",className:"fw-bold",children:"Materia"}),e.jsxs("select",{id:"materia",className:"form-select",value:c,onChange:s=>{var p;g(s.target.value);const o=((p=h.find(l=>l.id===s.target.value))==null?void 0:p.grupos)||[];b(o)},placeholder:"Seleccione la materia",children:[e.jsx("option",{value:"",children:"Seleccione la materia"}),Array.isArray(h)?h.map(s=>e.jsx("option",{value:s.id,children:s.materia},s.id)):e.jsx("option",{value:"",children:"No hay materias disponibles"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"grupos",className:"fw-bold",children:"Grupos de la materia"}),e.jsxs("select",{id:"grupo",className:"form-select",value:M,onChange:s=>x(s.target.value),placeholder:"Seleccione el grupo",children:[e.jsx("option",{value:"",children:"Seleccione el grupo"}),z.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))]})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"cantidad",className:"fw-bold",children:"Número estimado de estudiantes"}),e.jsx("input",{type:"number",id:"cantidad",className:"form-control",value:S,onChange:s=>E(s.target.value),placeholder:"Ingrese el número estimado de estudiantes"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"motivo",className:"fw-bold",children:"Motivo"}),e.jsxs("select",{id:"motivo",className:"form-select",value:j,onChange:s=>N(s.target.value),children:[e.jsx("option",{value:"",children:"Seleccione un motivo"}),e.jsx("option",{value:"Clase",children:"Clases"}),e.jsx("option",{value:"Examen",children:"Examen"}),e.jsx("option",{value:"Reunión",children:"Reunión"}),e.jsx("option",{value:"Conferencia",children:"Conferencia"})]})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"fecha",className:"fw-bold",children:"Fecha"}),e.jsx("input",{type:"date",id:"fecha",className:"form-control",value:y,onChange:s=>A(s.target.value),min:new Date().toISOString().split("T")[0]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"aula",className:"fw-bold",children:"Aula"}),e.jsxs("select",{id:"aula",className:"form-select",value:I,onChange:s=>C(s.target.value),children:[e.jsx("option",{value:"",children:"Seleccione un aula"}),F.map(s=>e.jsx("option",{value:s.id,children:s.nombreAulas},s.id))]})]})})]}),e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{htmlFor:"periodo",className:"fw-bold",children:"Período"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("select",{id:"periodo",className:"form-select",value:m,onChange:s=>D(s.target.value),children:[e.jsx("option",{value:"",children:"Seleccione un período"}),T.filter(s=>!t.some(o=>o.id===s.id)).map(s=>e.jsx("option",{value:s.id,children:s.nombreCompleto},s.id))]}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:k,style:{height:"calc(1.5em + 0.75rem + 2px)"},children:"Agregar Período"})]})]}),t.length>0&&e.jsxs("div",{children:[e.jsx("p",{children:"Períodos seleccionados:"}),e.jsx("ul",{children:t.map(s=>e.jsx("li",{children:`${s.horaInicio} - ${s.horaFin}`},s.id))})]}),e.jsx("div",{className:"form-group mb-3",children:e.jsxs("fieldset",{children:[e.jsx("legend",{className:"fw-bold",children:"Observaciones"}),e.jsx("div",{className:"form-group mb-3",children:e.jsx("textarea",{id:"observaciones",className:"form-control",rows:"3",placeholder:"Ingrese observaciones adicionales"})})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("button",{type:"button",className:"btn btn-primary me-2",onClick:G,children:"Registrar Reserva"}),e.jsx($,{to:"/",className:"btn btn-primary",children:"Volver"})]})]})})]})})})})}export{Y as default};
