import{r as t,j as e,d as R,e as k,U as E,B,D as G,E as g,F as o,H as I,a as M,b as O,n as c,I as i,i as v,o as w,a3 as W}from"./index-Caj9Gai4.js";import{g as Z,a as F,b as $}from"./servicios-BZT7n_SH.js";var q=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M440,424V88H352V13.005L88,58.522V424H16v32h86.9L352,490.358V120h56V456h88V424ZM320,453.642,120,426.056V85.478L320,51Z' class='ci-primary'/><rect width='32' height='64' x='256' y='232' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"];const X=()=>{const[u,C]=t.useState([]),[S,f]=t.useState(null),[l,h]=t.useState(""),[m,x]=t.useState(""),[p,j]=t.useState(""),[D,U]=t.useState(!1),[A,b]=t.useState(!1),[N,y]=t.useState(!1),[H,J]=t.useState(!1);t.useEffect(()=>{(async()=>{try{const r=await Z();console.log("Datos de unidades:",r);const d=r.map(n=>({...n,nombreDepartamentos:n.departamento&&n.departamento.nombreDepartamentos?n.departamento.nombreDepartamentos:"Ninguno"})).sort((n,P)=>n.nombreUnidades.localeCompare(P.nombreUnidades));C(d)}catch(r){console.error("Error al obtener las unidades:",r)}})()},[]);const V=a=>{f(a.id),h(a.nombreUnidades),x(a.horaAperturaUnidades),j(a.horaCierreUnidades)},T=async a=>{if(u.find(s=>s.nombreUnidades===l&&s.id!==a)){b(!0),setTimeout(()=>{b(!1)},3e3);return}try{await F(a,{nombreUnidades:l,horaAperturaUnidades:m,horaCierreUnidades:p});const s=u.map(d=>d.id===a?{...d,nombreUnidades:l,horaAperturaUnidades:m,horaCierreUnidades:p}:d);C(s),f(null),h(""),x(""),j(""),U(!0)}catch(s){console.error("Error al actualizar la unidad:",s),y(!0)}finally{setTimeout(()=>{U(!1),b(!1),y(!1)},3e3)}},z=async a=>{try{const r=await $(a);console.log("Aulas asociadas a la unidad:",r)}catch(r){console.error("Error al obtener las aulas asociadas:",r)}},L=a=>{const r=S===a.id;return e.jsxs(g,{children:[e.jsx(i,{children:r?e.jsx("input",{type:"text",value:l,onChange:s=>h(s.target.value)}):a.nombreUnidades}),e.jsx(i,{children:a.nombreDepartamentos}),e.jsx(i,{children:r?e.jsx("input",{type:"text",value:m,onChange:s=>x(s.target.value)}):a.horaAperturaUnidades}),e.jsx(i,{children:r?e.jsx("input",{type:"text",value:p,onChange:s=>j(s.target.value)}):a.horaCierreUnidades}),e.jsx(i,{children:e.jsx(E,{to:`/administracion/unidades/${a.id}/aulas`,className:"btn btn-primary ms-2",onClick:()=>z(a.id),children:e.jsx(v,{icon:q})})}),e.jsx(i,{children:r?e.jsx(w,{color:"success",onClick:()=>T(a.id),children:"Guardar"}):e.jsxs(w,{color:"primary",onClick:()=>V(a),children:[" ",e.jsx(v,{icon:W})]})})]},a.id)};return e.jsx("div",{className:"container",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",children:e.jsxs(R,{children:[e.jsxs(k,{children:[e.jsxs("div",{className:"d-flex justify-content-between mb-3",children:[e.jsx("h3",{children:"Lista de Unidades"}),e.jsx(E,{to:"/administracion/registrar-unidad",className:"btn btn-primary",children:"Agregar Unidad Nueva"})]}),e.jsxs(B,{striped:!0,bordered:!0,responsive:!0,children:[e.jsx(G,{children:e.jsxs(g,{children:[e.jsx(o,{children:"Nombre"}),e.jsx(o,{children:"Departamento"}),e.jsx(o,{children:"Hora de Apertura"}),e.jsx(o,{children:"Hora de Cierre"}),e.jsx(o,{children:"Ver aulas"}),e.jsx(o,{children:"Editar"})]})}),e.jsx(I,{children:u.map(a=>L(a))})]})]}),e.jsx(M,{children:e.jsxs(O,{children:[D&&e.jsx(c,{color:"success",children:"Unidad actualizada correctamente"}),A&&e.jsx(c,{color:"warning",children:"El nombre de la unidad ya está en uso. Por favor, ingrese un nombre diferente."}),N&&e.jsx(c,{color:"danger",children:"Ocurrió un error al actualizar la unidad. Por favor, inténtelo de nuevo."}),H&&e.jsx(c,{color:"warning",children:"Por favor, ingrese un nombre para el departamento."})]})})]})})})})};export{X as default};
